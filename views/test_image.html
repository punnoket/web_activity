<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->

<html>

<head>
  <title>TODO supply a title</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">

  <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.0/jquery-ui.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

  <body>

    </div>
    <li> เลือกรูปภาพ</li>
    <br>
    <div class="formField">
      <div class="w3-col w3-container m3 l2"></div>
      <!-- just make it beauty-->
      <img id="blah" src="#" alt="your image" />
      <br>
      <div class="w3-col w3-container m1 l2"></div>
      <!-- just make it beauty-->
      <input type='file' onchange="readURL(this);" />
      <p id="txt"></p>
      <button onclick="createActivity()">create</button>


  </body>
  <!-- W3.CSS Container -->

</html>

<script>
  var file

  function readURL(input) {

    if (input.files && input.files[0]) {
      var reader = new FileReader();
      file = input.files[0]

      reader.onload = function(e) {
        $('#blah')
          .attr('src', e.target.result)
          .width(150)
          .height(200);
      };

      reader.readAsDataURL(input.files[0]);

    }
  }


  function createActivity() {
    console.log(555);
    var img
    var reader = new FileReader();
    reader.onload = function(e) {

      img = e.target.result
      activity = {
        'name': "test",
        'type': "test",
        'location': "test",
        'result_vote': "test",
        'key': "test",
        'description': "test",
        'image': img,
        'exprie': "test",
        'date': "test",
      }

      $.ajax({
        type: "POST",
        url: "/add_activity",
        data: JSON.stringify(activity),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(data) {
          console.log(data);
        },
        failure: function(errMsg) {}
      });

    };

    reader.readAsDataURL(file);
  }
</script>
